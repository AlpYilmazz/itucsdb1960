{% extends "layout.html" %}
{% block title %} Lost & Found {% endblock %}
{% block stylesheet %} "/static/style_lostfound.css" {% endblock %}

{% block body_content %}
	<h2> Share a new post </h2>
	<form action="/lostfound" method="post">
		<input type="text" name="title" placeholder="Enter a title (max 32 chars)" required>
		<input type="text" name="location" placeholder="(Optional) Enter location">
		<br>
		<textarea name="description" rows="5" cols="45" placeholder="Additional information and description" required></textarea>
		<br>
		<input type="radio" name="LF" value=TRUE required> Found
		<input type="radio" name="LF" value=FALSE required> Lost
		<br>
		<input type="submit" name="Send">
	</form>

	<h2> Latest Posts </h2>
	{% if posts %}
	<table class="lfposts" id="lfposts_table">
		<tr>
			<th onclick="sortTable('title')"> Title </th>
			<th onclick="sortTable('username')"> Shared by </th>
			<th onclick="sortTable('category')"> Category </th>
			<th onclick="sortTable('location')"> Location </th>
		</tr>
		{% for postid, title, username, LF, location in posts %}
		<tr>
			<td class="title"> <a class="lfpost_link" href="/lostfound/{{postid}}">{{ title }}</a> </td>
			<td> {{ username }} </td>
			<td> {% if LF %} Found {% else %} Lost {% endif %} </td>
			<td> {% if location %} {{ location }} {% else %} --- {% endif %} </td>
		</tr>
		{% endfor %}
	</table>

	<script>
		function sortTable(column) {
            var col_num;
            switch(column){
                case "title":
                    col_num = 0;
                    break;
                case "username":
                    col_num = 1;
                    break;
                case "category":
                    col_num = 2;
                    break;
                case "location":
                    col_num = 3;
                    break;
            }

            var table, rows;
            var switching;
            var i, el1, el2; // row index, element1 and element2
            var swap;        // boolean flag
            table = document.getElementById("lfposts_table");
            switching = true;

            while (switching) {
                switching = false;
                rows = table.rows;

                for (i = 1; i < (rows.length - 1); i++) {
                    swap = false;
                    el1 = rows[i].getElementsByTagName("TD")[col_num];
                    el2 = rows[i + 1].getElementsByTagName("TD")[col_num];
                    if (el1.innerHTML.toLowerCase() > el2.innerHTML.toLowerCase()) {
                        swap = true;
                        break;
                    }
                }

                if (swap) {
                    rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
                    switching = true;
                }
            }
        }
	</script>

	{% else %} No posts found.
	{% endif %}

{% endblock %}
